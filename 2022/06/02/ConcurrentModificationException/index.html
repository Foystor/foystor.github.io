<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Exception in thread &#34;AWT-EventQueue-0&#34; java.util.ConcurrentModificationException | FoYuri</title><meta name="robots" content="noindex">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="ProblemWhen I used foreach-loop and lambda to apply a specific function to each element in a set data structure, the program threw the exception below: Exception in thread &quot;AWT-EventQueue-0&quot;">
<meta property="og:type" content="article">
<meta property="og:title" content="Exception in thread &quot;AWT-EventQueue-0&quot; java.util.ConcurrentModificationException">
<meta property="og:url" content="https://foystor.github.io/2022/06/02/ConcurrentModificationException/index.html">
<meta property="og:site_name" content="FoYuri">
<meta property="og:description" content="ProblemWhen I used foreach-loop and lambda to apply a specific function to each element in a set data structure, the program threw the exception below: Exception in thread &quot;AWT-EventQueue-0&quot;">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2022-06-02T11:01:00.000Z">
<meta property="article:modified_time" content="2024-07-01T04:41:37.842Z">
<meta property="article:author" content="Foy Wan">
<meta property="article:tag" content="Java">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="FoYuri" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 7.2.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">FoYuri</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://foystor.github.io"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-ConcurrentModificationException" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/06/02/ConcurrentModificationException/" class="article-date">
  <time class="dt-published" datetime="2022-06-02T11:01:00.000Z" itemprop="datePublished">2022-06-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Coding-Bugfix/">Coding - Bugfix</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      Exception in thread &#34;AWT-EventQueue-0&#34; java.util.ConcurrentModificationException
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>When I used <code>foreach-loop</code> and <code>lambda</code> to apply a specific function to each element in a set data structure, the program threw the exception below:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Exception in thread &quot;AWT-EventQueue-0&quot; java.util.ConcurrentModificationException</span><br></pre></td></tr></table></figure>

<h2 id="What’s-wrong"><a href="#What’s-wrong" class="headerlink" title="What’s wrong"></a>What’s wrong</h2><p>That was because:</p>
<blockquote>
<p>The for-each loop is used with both collections and arrays. It’s intended to simplify the most common form of iteration, where the iterator or index is used solely for iteration, and not for any other kind of operation, such as removing or editing an item in the collection or array.</p>
</blockquote>
<p><strong>We should avoid modifying elements in a set while iterating that set.</strong></p>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>There are two simple ways to fix that problem:</p>
<ol>
<li><p><strong>Use the normal <code>for loop</code></strong></p>
<p> With the <code>for (int i...) loop</code>, we are not iterating the set, so we can modify the elements inside.</p>
</li>
<li><p><strong>Synchronize the operations properly</strong></p>
<p> We can use a concurrent set whose iterators won’t give the exception, such as <code>ConcurrentSkipListSet</code>.</p>
<p> In my case, I can change my code:</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">getSensors().forEach(sensor -&gt; changeSensorActivationStatus(sensor,<span class="literal">false</span>));</span><br></pre></td></tr></table></figure>

<p> to the code below:</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ConcurrentSkipListSet&lt;Sensor&gt; sensors = <span class="keyword">new</span> <span class="title class_">ConcurrentSkipListSet</span>&lt;&gt;(getSensors());</span><br><span class="line">sensors.forEach(sensor -&gt; changeSensorActivationStatus(sensor,<span class="literal">false</span>));</span><br></pre></td></tr></table></figure></li>
</ol>
<p><br/><br/><br/><br/></p>
<p><strong><em>References</em></strong></p>
<p><em><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/17067626/java-arraylist-and-exception-in-thread-awt-eventqueue-0-java-util-concurrentm">Java ArrayList and Exception in thread “AWT-EventQueue-0” java.util.ConcurrentModificationException</a></em></p>
<p><em><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/6958478/how-to-modify-a-collection-while-iterating-using-for-each-loop-without-concurren">How to modify a Collection while iterating using for-each loop without ConcurrentModificationException?</a></em></p>
<p><em><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/18397075/threads-in-java-awt-eventqueue-0-java-util-concurrentmodificationexception">Threads in Java. “AWT-EventQueue-0” java.util.ConcurrentModificationException</a></em></p>
<!-- flag of hidden posts -->
      
    </div>
    <footer class="article-footer">
      <a data-url="https://foystor.github.io/2022/06/02/ConcurrentModificationException/" data-id="cly2x1h1f0004i78o283p6rfy" data-title="Exception in thread &#34;AWT-EventQueue-0&#34; java.util.ConcurrentModificationException" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/" rel="tag">Java</a></li></ul>

    </footer>
  </div>
  
    
  
</article>


</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Manga/">Manga</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/TV-series/">TV series</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/cp/" rel="tag">cp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/intro/" rel="tag">intro</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/material-collection/" rel="tag">material collection</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/cp/" style="font-size: 10px;">cp</a> <a href="/tags/intro/" style="font-size: 10px;">intro</a> <a href="/tags/material-collection/" style="font-size: 10px;">material collection</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/07/">July 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/04/">April 2022</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2022/07/18/%E4%BB%98%E3%81%8D%E5%90%88%E3%81%A3%E3%81%A6%E3%81%82%E3%81%92%E3%81%A6%E3%82%82%E3%81%84%E3%81%84%E3%81%8B%E3%81%AA/">付き合ってあげてもいいかな Girls Love Manga</a>
          </li>
        
          <li>
            <a href="/2022/04/26/daokoi/">DaoKoi(FonBelle) Sweet On-Screen Couple</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2024 Foy Wan<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>